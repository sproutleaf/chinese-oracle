<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Miaoye Que">
    <link rel="stylesheet" href="style.css" type="text/css">
    <title>Chinese Oracle</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/typed.js@2.0.16/dist/typed.umd.js"></script>
</head>

<body>
    <div id="w">

        <div id="about" onclick="showContent('popup')" data-secret="hohoho">⁂ about ⁂</div>

        <div id="yi">
            <div class="title">
                GOOD FOR
            </div>
        </div>
        <img id="oracle" src="./images/bagua.png" alt="bagua" onclick="showOracle()">
        <div id="ji">
            <div class="title">
                AVOID
            </div>
        </div>
        <div id="caption"></div>
    </div>

    <div id="popup">
        <div id="popup-content">
            <p>Chinese Oracle was originally created by <a href="https://www.yourworldoftext.com/~miaoye/"
                    target="_blank" rel="noopener noreferrer">Miaoye Que</a> for Tega Brain's class: Crafting the Web.
                Maintained and updated
                with care.</p>
            <p>Special thanks to: Tim Busuttil's <a href="https://crawlspace.cool/if-i-were-able" target="_blank"
                    rel="noopener noreferrer">If I were able</a>, Agnes + Gary's <a href="https://backseatfrying.net/"
                    target="_blank" rel="noopener noreferrer">Backseat Frying</a>, my Chinese heritage.</p>
            <p style="text-align: center;">(CLICK ANYWHERE IN THIS WINDOW TO CLOSE)</p>
        </div>
    </div>


    <script>
        const rec = ["Drink Hot Water", "Get a Massage", "Foot Bath", "Stretch 3 Times a Day", "Eat Congee", "Green Tea", "Psychic Reading", "Practice Your Qi", "Acupuncture", "Burn Incense", "Talk to Elders", "Play Mahjong", "Sweet Tofu", "Stroll in a Park"],
            avoid = ["All Nighter", "Alcohol", "Caffeine", "Doomscrolling", "Fast Food", "Pessimism", "Wear a Crop Top", "Crowded Spaces", "Large Bodies of Water", "Spicy Food", "Cynical People"];
        let q = (e) => document.querySelector(e),
            shown = false,
            num = 3,
            shuffle = (arr) => {
                let j, x, i;
                for (i = arr.length - 1; i > 0; i--) {
                    j = Math.floor(Math.random() * (i + 1));
                    x = arr[i];
                    arr[i] = arr[j];
                    arr[j] = x;
                }
                return arr;
            };
        function showContent(e) {
            let x = document.getElementById(e);
            if (!x.style.display || x.style.display == 'none') {
                x.style.display = 'flex';
                let w = document.getElementById("w");
                w.style.filter = "blur(3px)";
            }
        }
        q("#popup").addEventListener('click', () => {
            let popup = document.getElementById("popup");
            if (popup.style.display == 'flex') {
                popup.style.display = 'none';
                w.style.filter = null;
            }
        });
        $(document).ready(function () {
            typed = new Typed('#caption', {
                strings: ['CONSULT THE CHINESE ORACLE TODAY', 'LIVE YOUR BEST LIFE THE CHINESE WAY', 'PERFECT DOS AND DON\'TS', 'ORIENT YOUR DAY WITH THE ORACLE\'S ADVICE'],
                typeSpeed: 100,
                startDelay: 200,
                backDelay: 1500,
                backSpeed: 30,
                loop: true,
                showCursor: false,
            });
        });
        showOracle = () => {
            shuffle(rec);
            shuffle(avoid);

            if (!shown) {
                let titles = document.getElementsByClassName("title");
                for (let i = 0; i < titles.length; i++) {
                    titles[i].style.display = "block";
                }
                for (let i = 0; i < num; i++) {
                    let e = document.createElement(`y${i}`),
                        f = document.createElement(`j${i}`);
                    q("#yi").appendChild(e),
                        e.classList.add("yi"),
                        e.classList.add("row"),
                        e.setAttribute("id", `y${i}`),
                        e.innerHTML += rec[i];
                    q("#ji").appendChild(f),
                        f.classList.add("ji"),
                        f.classList.add("row"),
                        f.setAttribute("id", `j${i}`),
                        f.innerHTML += avoid[i];
                }
                shown = true;
            } else {
                for (let i = 0; i < num; i++) {
                    q(`y${i}`).innerHTML = rec[i];
                    q(`j${i}`).innerHTML = avoid[i];
                }
            }
        }
    </script>

</body>

</html>